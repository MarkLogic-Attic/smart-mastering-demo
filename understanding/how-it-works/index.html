<!doctype html>
<!--[if lt IE 7 ]><html itemscope itemtype="http://schema.org/Organization" id="ie6" class="ie ie-old" lang="en-US"><![endif]-->
<!--[if IE 7 ]>   <html itemscope itemtype="http://schema.org/Organization" id="ie7" class="ie ie-old" lang="en-US"><![endif]-->
<!--[if IE 8 ]>   <html itemscope itemtype="http://schema.org/Organization" id="ie8" class="ie ie-old" lang="en-US"><![endif]-->
<!--[if IE 9 ]>   <html itemscope itemtype="http://schema.org/Organization" id="ie9" class="ie" lang="en-US"><![endif]-->
<!--[if gt IE 9]><!--><html itemscope itemtype="http://schema.org/Organization" lang="en-US"><!--<![endif]-->
<head>

    <!-- Meta -->
    <meta charset="utf-8">
    <title>How It Works - Data Hub Framework</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
    <meta content="yes" name="apple-mobile-web-app-capable">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <!-- Favicons -->
    <link rel="shortcut icon" sizes="16x16 24x24 32x32 48x48 64x64 96x96" href="/marklogic-data-hub/favicon.ico">
    <meta name="application-name" content="Data Hub Framework - A data hub framework for MarkLogic">
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-6638631-15', 'auto');
      ga('send', 'pageview');

    </script>

    <!-- Facebook Pixel Code -->
    <script>
    !function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?
    n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;
    n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;
    t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window,
    document,'script','https://connect.facebook.net/en_US/fbevents.js');
    fbq('init', '1879746318909687'); // Insert your pixel ID here.
    fbq('track', 'PageView');
    </script>
    <noscript><img height="1" width="1" style="display:none"
    src="https://www.facebook.com/tr?id=1879746318909687&ev=PageView&noscript=1"
    /></noscript>
    <!-- DO NOT MODIFY -->
    <!-- End Facebook Pixel Code -->
    <link type="text/css" rel="stylesheet" href="/marklogic-data-hub/assets/bundle.css">
</head>
<body class="">

    <nav class="navbar navbar-inverse">
        <div class="container-fluid">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="/marklogic-data-hub">
                  <span class="logo">
                    <img src="/marklogic-data-hub/images/logo-marklogic.svg" width="150px" height="36px" alt="MarkLogic" title="MarkLogic" scale="0">
                  </span>
                  Data Hub Framework
                </a>
            </div>
            <div id="navbar" class="navbar-collapse collapse">
                <ul class="nav navbar-nav navbar-right">
                    
                        <li  >
                            
                            <a href="/marklogic-data-hub/">Getting Started</a>
                            
                        </li>
                    
                        <li  >
                            
                            <a href="/marklogic-data-hub/tutorial/">Tutorial</a>
                            
                        </li>
                    
                        <li  >
                            
                            <a href="https://github.com/marklogic-community/marklogic-data-hub">DHF on GitHub</a>
                            
                        </li>
                    
                </ul>
            </div>
        </div>
    </nav>




  <div class="bannered-image">
  <picture>
    <source srcset="/marklogic-data-hub/images/Solution-enterprise-data-hub-xs.jpg" media="(max-width: 400px)">
    <source srcset="/marklogic-data-hub/images/Solution-enterprise-data-hub-sm.jpg" media="(max-width: 800px)">
    <source srcset="/marklogic-data-hub/images/Solution-enterprise-data-hub-lg.jpg" media="(min-width: 801px)">
    <img srcset="/marklogic-data-hub/images/Solution-enterprise-data-hub-lg.jpg" alt="Operational Data Hub" scale="0">
  </picture>
  <div class="banner banner-light banner-center text-center">
    <div class="center-container">
      <div class="centered-text">
        <div class="col-sm-12 text-right text-center">
          <img alt="dhf icon" src="/marklogic-data-hub/images/odh.svg" scale="0" class="icon-left">
          <h3>
          
            How It Works
          
          </h3>
        </div>
      </div>
    </div>
  </div>
</div>


  <article>
    <div class="container">
      <div class="row">
        <div class="side-nav col-md-2 hide-small">
          <div class="panel panel-default">
  <div class="panel-heading">Navigation</div>
  <ul class="list-group">
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-data-hub/">Getting Started</a>
    
    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-data-hub/understanding/">Understanding DHF</a>
    
    
      <ul class="list-group">
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-data-hub/understanding/concepts/">Concepts</a>
    
    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-data-hub/understanding/architecture/">Architecture</a>
    
    
  </li>
  
  <li  class="list-group-item active"  >
    
    <a href="/marklogic-data-hub/understanding/how-it-works/">How It Works</a>
    
    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-data-hub/understanding/flowtracing/">Flow Tracing</a>
    
    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-data-hub/understanding/project-structure/">Project Structure</a>
    
    
  </li>
  
</ul>

    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-data-hub/tutorial/">Tutorial</a>
    
    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-data-hub/using/">Using the DHF</a>
    
    
      <ul class="list-group">
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-data-hub/project/">Create a Project</a>
    
    
      <ul class="list-group">
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-data-hub/project/quickstart/">QuickStart</a>
    
    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-data-hub/project/gradle/">Gradle Plugin</a>
    
    
  </li>
  
</ul>

    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-data-hub/ingest/">Ingest</a>
    
    
      <ul class="list-group">
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-data-hub/ingest/quickstart/">QuickStart</a>
    
    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-data-hub/ingest/mlcp/">MLCP</a>
    
    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-data-hub/ingest/marklogic-client-api/">MarkLogic Client API</a>
    
    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-data-hub/ingest/rest/">REST API</a>
    
    
  </li>
  
</ul>

    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-data-hub/harmonize/">Harmonize</a>
    
    
      <ul class="list-group">
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-data-hub/harmonize/quickstart/">Quickstart</a>
    
    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-data-hub/harmonize/gradle/">Gradle</a>
    
    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-data-hub/harmonize/java/">Java Library</a>
    
    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-data-hub/harmonize/rest/">REST</a>
    
    
  </li>
  
</ul>

    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-data-hub/serve/">Serve</a>
    
    
      <ul class="list-group">
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-data-hub/serve/rest/">REST</a>
    
    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-data-hub/serve/odbc/">ODBC</a>
    
    
  </li>
  
</ul>

    
  </li>
  
</ul>

    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-data-hub/docs/">Docs</a>
    
    
      <ul class="list-group">
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-data-hub/docs/gradle-tasks/">Gradle Tasks</a>
    
    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-data-hub/docs/server-side/">Server Side (xqy, sjs)</a>
    
    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-data-hub/javadocs/">Javadocs</a>
    
    
  </li>
  
</ul>

    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-data-hub/faqs/">FAQs</a>
    
    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="https://github.com/marklogic-community/marklogic-data-hub">DHF on GitHub</a>
    
    
  </li>
  
</ul>

</div>

        </div>
        <div class="col-md-10">
          <h2 id="envelope-pattern">Envelope Pattern</h2>
<p>The Data Hub Framework uses the Envelope data pattern to encapsulate data. Simply put, the Envelope pattern wraps your data in either XML or JSON like so:</p>

<div class="row">
<div class="col-md-6">

    <div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="nt">&lt;envelope&gt;</span>
  <span class="nt">&lt;headers/&gt;</span>
  <span class="nt">&lt;triples/&gt;</span>
  <span class="nt">&lt;instance&gt;</span>
    your data goes here
  <span class="nt">&lt;/instance&gt;</span>
<span class="nt">&lt;/envelope&gt;</span>

</code></pre></div>    </div>

  </div>
<div class="col-md-6">

    <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"envelope"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"headers"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
    </span><span class="s2">"triples"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
    </span><span class="s2">"instance"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"your data"</span><span class="p">:</span><span class="w"> </span><span class="s2">"goes here"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>    </div>

  </div>
</div>

<p>The advantage to wrapping data is that you can retain the original data untouched (if you so desire) while allowing you to add additional data.</p>

<p>As an example. Let’s say you have two data sources that have gender information. Perhaps the field names and the formats differ.</p>

<div class="row">
<div class="col-md-6">

    <p><strong>/source-1.json</strong></p>

    <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"gender"</span><span class="p">:</span><span class="w"> </span><span class="s2">"f"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"age"</span><span class="p">:</span><span class="w"> </span><span class="s2">"32"</span><span class="p">,</span><span class="w">
  </span><span class="err">...</span><span class="p">,</span><span class="w">
  </span><span class="s2">"firstName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Rebecca"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>    </div>

  </div>

<div class="col-md-6">

    <p><strong>/source-2.json</strong></p>

    <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"gndr"</span><span class="p">:</span><span class="w"> </span><span class="s2">"female"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"age"</span><span class="p">:</span><span class="w"> </span><span class="s2">"39"</span><span class="p">,</span><span class="w">
  </span><span class="err">...</span><span class="p">,</span><span class="w">
  </span><span class="s2">"firstName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Leona"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>    </div>

  </div>
</div>

<p>With the envelope you can normalize the fields into a preferred format:</p>

<div class="row">
<div class="col-md-6">

    <p><strong>/harmonized-1.json</strong></p>

    <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"headers"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w"> </span><span class="s2">"normalizedGender"</span><span class="p">:</span><span class="w"> </span><span class="s2">"female"</span><span class="w"> </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="s2">"triples"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
  </span><span class="s2">"content"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"gender"</span><span class="p">:</span><span class="w"> </span><span class="s2">"f"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"age"</span><span class="p">:</span><span class="w"> </span><span class="s2">"32"</span><span class="p">,</span><span class="w">
    </span><span class="err">...</span><span class="p">,</span><span class="w">
    </span><span class="s2">"firstName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Rebecca"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>    </div>

  </div>

<div class="col-md-6">

    <p><strong>/harmonized-2.json</strong></p>

    <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"headers"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w"> </span><span class="s2">"normalizedGender"</span><span class="p">:</span><span class="w"> </span><span class="s2">"female"</span><span class="w"> </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="s2">"triples"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
  </span><span class="s2">"content"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"gndr"</span><span class="p">:</span><span class="w"> </span><span class="s2">"female"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"age"</span><span class="p">:</span><span class="w"> </span><span class="s2">"39"</span><span class="p">,</span><span class="w">
    </span><span class="err">...</span><span class="p">,</span><span class="w">
    </span><span class="s2">"firstName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Leona"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>    </div>

  </div>
</div>

<p>Now searching your data becomes much easier because you have a consistent field name to query.</p>

<h2 id="entities-flows-and-plugins-oh-my">Entities, Flows, and Plugins. Oh My!</h2>
<p>The MarkLogic Data Hub Framework is organized into <strong>Entities</strong>, <strong>Flows</strong>, and <strong>Plugins</strong>.</p>

<h3 id="entities">Entities</h3>
<p>Entities are the high level business objects in your enterprise. They can be things like Employee, Product, Purchase Order, Department, etc.</p>

<p>With the DHF you have a choice between using abstract entities or Entity Services in MarkLogic 9, which we strongly recommend unless you have specific needs that Entity Services cannot address. Entity Services is an out-of-the-box API and a set of conventions you can use within MarkLogic to quickly stand up an application based on entity modeling. This means Entity Services handles the model definition and entity instance envelope documents for you via API calls - if you choose to use your own abstract entities, you will need to provide this framework yourself.</p>

<p>More detailed information can be found in the <a href="https://docs.marklogic.com/guide/entity-services/intro">Introduction to Entity Services</a> developer guide.</p>

<h3 id="flows">Flows</h3>
<p>Flows are the means by which you harmonize your data. There are two types of Flows: <strong>Input</strong> and <strong>Harmonize</strong>. Flows belong to Entities. Think of a flow as a way of creating an envelope that represents an entity. Flows are made up of Plugins.</p>

<h4 id="input-flows">Input Flows</h4>

<p>Input Flows are specialized Flows that get invoked via MLCP or the REST API as transforms that process one incoming document before it gets written into MarkLogic. Because these flows run as transforms, they are not responsible for persisting data. They merely transform the given data into envelopes. It is MLCP or the REST API that will write the final, transformed document into MarkLogic.</p>

<p>Input Flows are useful for tracking information about data in your Staging Database.</p>
<ul>
  <li>Which system did the data come from?</li>
  <li>What date/time was the data loaded?</li>
  <li>Who loaded the data?</li>
  <li>Has the data been harmonized yet?</li>
</ul>

<p>Input Flows consist of four parts:</p>
<ul>
  <li><strong>Main Plugin.</strong> The main plugin orchestrates the running of the other 3 plugins.</li>
  <li><strong>Content Plugin.</strong> The content plugin tells the system which data to store in the <strong>instance</strong> section of the envelope.</li>
  <li><strong>Headers Plugin.</strong> The headers plugin returns a list of headers to store in the <strong>headers</strong> section of the envelope.</li>
  <li><strong>Triples Plugin.</strong> The triples plugin returns a list of semantic triples to store in the <strong>triples</strong> section of the envelope.</li>
</ul>

<h4 id="harmonize-flows">Harmonize Flows</h4>

<p>Harmonize Flows are meant to run in batches. The primary purpose of the Data Hub Framework is to run Harmonize Flows.</p>

<p>Harmonize Flows have six plugins:</p>

<p>There is one plugin for each piece of the envelope (headers, triples, and content).</p>

<ul>
  <li><strong>Main Plugin.</strong> The main plugin orchestrates the running of the other 5 plugins.</li>
  <li><strong>Collector Plugin.</strong> The collector plugin returns a list of strings that will be batch processed by the harmonize flow. These strings can be anything from document URIs in the database to IDs. Collectors are only used for Harmonize Flows. Harmonize Flows run as batches and need a list of things to operate on. Input Flows run per document and do not need Collectors.</li>
  <li><strong>Content Plugin.</strong> The content plugin tells the system which data to store in the <strong>instance</strong> section of the envelope.</li>
  <li><strong>Headers Plugin.</strong> The headers plugin returns a list of headers to store in the <strong>headers</strong> section of the envelope.</li>
  <li><strong>Triples Plugin.</strong> The triples plugin returns a list of semantic triples to store in the <strong>triples</strong> section of the envelope.</li>
  <li><strong>Writer Plugin.</strong> The writer plugin is responsible for saving the final envelope to disk.</li>
</ul>

<p>Because Harmonize Flows run in batches, the DHF uses the <a href="https://developer.marklogic.com/learn/data-movement-sdk">Data Movement SDK (DMSDK)</a> to orchestrate the batching.
<br /></p>
<div class="text-center" style="font-style: italic">This data flow diagram details how a Harmonize Flow is executed.</div>
<p><img src="/marklogic-data-hub/images/2x/harmonize-flow-diagram.png" alt="Harmonize Flow Overview" title="This data flow diagram details how a Harmonize Flow is executed." class="center-image" /></p>

<p><strong>But I don’t want to run my Harmonize Flow in batches!</strong> - See our <a href="/marklogic-data-hub/faqs/#how-can-i-run-a-harmonize-flow-immediately-for-1-document">FAQ</a> about this.</p>

        </div>
      </div>
    </div>
  </article>


    <footer class="site-footer">
        <div class="container">
            <div class="row">
                <div class="col-md-12">
                    <p>
                    Copyright © 2016-2018 MarkLogic Corporation. All Rights Reserved. MARKLOGIC® is a registered trademark of MarkLogic Corporation.
                    </p>
                </div>
            </div>
        </div>
    </footer>


    <!--[if lt IE 9]>
        <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.2/html5shiv.min.js"></script>
        <script src="/marklogic-data-hub/js/respond.min.js"></script>
    <![endif]-->

    <script type="text/javascript" src="/marklogic-data-hub/assets/bundle.js" id="1"></script>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-79716597-1', 'auto');
      ga('send', 'pageview');
    </script>
  </body>
</html>

